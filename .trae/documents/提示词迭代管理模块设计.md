# 提示词迭代管理模块设计方案

为了让您更灵活地管理和修改提示词，我们将把提示词从 Python 代码 (`src/prompts.py`) 中解耦出来，改为使用 **YAML 或 JSON** 格式的配置文件进行管理。这样您就可以在不修改代码的情况下，直接编辑文本文件来更新提示词。

## 1. 核心设计

### 1.1 提示词文件结构
在 `src/` 下创建一个 `templates/` 目录，用于存放 YAML 格式的提示词模板。

建议结构：
```text
src/templates/
├── single.yaml       # Single 策略的提示词
├── stepwise.yaml     # Stepwise 策略的提示词
├── cot.yaml          # CoT 策略的提示词
└── reflection.yaml   # Reflection 策略的提示词
```

### 1.2 YAML 模板示例 (`single.yaml`)
```yaml
system_prompt: |
  You are a literature annotator...
  (这里是完整的 System Prompt 内容)

user_prompt_template: |
  [TITLE] {title}
  [ABSTRACT] {abstract}

examples:
  one_shot: |
    Example:
    Title: ...
    Output: ...
  few_shot: |
    Examples:
    ...
```

### 1.3 代码改造 (`src/prompts.py`)
*   **移除硬编码字符串**：删除原来的大段字符串常量。
*   **新增加载逻辑**：`PromptGenerator` 类初始化时，读取 `templates/` 目录下的 YAML 文件。
*   **动态渲染**：使用 Jinja2 或简单的字符串替换（如 `{title}`）来填充模板。

## 2. 实施计划

### Step 1: 创建模板目录与文件
*   创建 `src/templates/`。
*   将 `src/prompts.py` 中现有的 Prompt 内容提取出来，分别写入对应的 YAML 文件中。

### Step 2: 引入依赖
*   虽然可以用 Python 内置的 `string.Template`，但为了更强大的模板功能（如循环、条件判断），推荐引入 `jinja2`（或者保持简单，只用 f-string 逻辑）。考虑到依赖最小化，我们将使用 Python 自带的 `yaml` 解析库（需安装 `PyYAML`）。

### Step 3: 重构 `PromptGenerator`
*   修改 `__init__` 方法，加载 YAML 文件。
*   修改 `get_single_system_prompt` 等方法，改为从加载的字典中获取内容并返回。

### Step 4: 验证
*   运行 `main.py` 的测试模式，确保提取出的 Prompt 与原来一致。

## 3. 具体文件变更

1.  **新建** `src/templates/base.yaml` (通用定义)
2.  **新建** `src/templates/strategies.yaml` (包含各策略特有的 Prompt)
3.  **修改** `src/prompts.py` (改为加载器逻辑)
4.  **修改** `requirements.txt` (添加 `PyYAML`)

## 4. 优势
*   **热更新**：修改 YAML 后无需重启程序（如果每次运行都重新加载）。
*   **版本管理**：可以为 Prompt 文件建立 Git 版本控制，方便回滚。
*   **清晰易读**：YAML 的多行字符串语法比 Python 代码中的字符串拼接更易于维护。
