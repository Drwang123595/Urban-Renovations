# 项目结构重构计划

您现在的项目结构确实比较分散，顶层目录下混杂了脚本、配置文件和文件夹。我们将按照标准的 Python 项目结构进行整理。

## 1. 目标目录结构

```text
Urban Renovation/
├── Data/                   # 存放数据
│   ├── train/              # 原始上传文件
│   └── {task_name}/        # 任务工作区 (output/labels/Result)
├── scripts/                # 存放顶层执行脚本
│   ├── main.py             # 主运行脚本
│   ├── evaluate.py         # 评估脚本
│   └── chat_manager.py     # (如果需要保留)
├── src/                    # 源代码包
│   ├── __init__.py
│   ├── config.py           # 配置文件
│   ├── data_processor.py   # 数据处理核心
│   ├── llm_client.py       # LLM 客户端
│   ├── prompts.py          # 提示词管理
│   ├── memory.py           # 记忆模块
│   └── strategies/         # 策略子模块
│       ├── ...
├── notebooks/              # Jupyter Notebooks (迁移原 llm_extraction/notebooks)
│   └── experiment1_extraction.ipynb
├── tests/                  # 测试代码 (迁移散落在外的测试脚本)
│   └── test_multiturn_dialogue.py
├── legacy/                 # 归档旧代码 (整理 evaluate_result1.py 等)
│   ├── evaluate_result1.py
│   ├── extract_study_area_llm.py
│   └── ...
├── .env                    # 环境变量
└── requirements.txt        # 依赖列表
```

## 2. 迁移与修改计划

为了不修改代码逻辑但调整结构，我们需要**移动文件**并**修正导入路径**。

### 2.1 文件移动操作

1.  **创建新文件夹**：`scripts/`, `tests/`, `notebooks/`, `legacy/`。
2.  **移动脚本**：
    *   `main.py`, `evaluate.py`, `chat_manager.py` -> `scripts/`
    *   `test_multiturn_dialogue.py` -> `tests/`
    *   `evaluate_result1.py` -> `legacy/`
    *   `llm_extraction/python/*` -> `legacy/`
    *   `llm_extraction/notebooks/*` -> `notebooks/` (然后删除空目录 `llm_extraction`)

### 2.2 修正导入路径 (关键步骤)

由于脚本位置变动，原本的 `sys.path.append(...)` 逻辑需要调整。

*   **对于 `scripts/` 下的文件 (`main.py`, `evaluate.py`)**：
    *   原本它们在根目录，直接 `import src.config` 或 `sys.path.append(...)`。
    *   现在它们在 `scripts/` 子目录，需要确保能找到上一级的 `src` 包。
    *   **通用修复方案**：在每个脚本开头添加：
        ```python
        import sys
        from pathlib import Path
        # 将项目根目录添加到 sys.path
        PROJECT_ROOT = Path(__file__).resolve().parent.parent
        sys.path.append(str(PROJECT_ROOT))
        ```
    *   这样修改后，`from src.config import Config` 依然有效。

*   **对于 `tests/` 下的文件**：同上处理。

*   **对于 `src/config.py`**：
    *   原本 `PROJECT_ROOT` 定义为 `Path(__file__).resolve().parent.parent` (即 src 的上一级)。
    *   由于 `src` 位置没变，`config.py` 的相对路径逻辑依然正确，**无需修改**。

## 3. 实施步骤

1.  **创建目录**：创建 `scripts`, `tests`, `legacy` 等文件夹。
2.  **移动文件**：将根目录下的 `.py` 文件按分类移动。
3.  **更新脚本导入路径**：批量修改 `scripts/main.py`, `scripts/evaluate.py` 等文件的 `sys.path` 设置代码。
4.  **清理**：删除空的旧目录。

这样调整后，根目录将非常清爽，只剩下 `Data/`, `src/`, `scripts/` 以及必要的配置/说明文件。
