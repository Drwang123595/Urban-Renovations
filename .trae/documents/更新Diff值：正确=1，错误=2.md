# 优化列排布：指标相邻存放

抱歉之前的理解有误。您的核心需求是 **Result 下的 Detail Comparison 页面中，同一个指标的真值和预测值必须相邻存放**，以便于观察。

虽然我之前的计划中已经包含了“列重排”的逻辑，但可能在代码实现细节上还需要针对“空间等级”等更多指标进行显式的配置和处理。

## 1. 现状分析

目前的 `mappings` 只配置了两个指标：

1. `是否属于城市更新研究`
2. `空间研究/非空间研究`

如果您的数据中还包含 `空间等级`、`具体空间描述` 等其他指标，目前的代码并没有把它们纳入重排逻辑，而是作为“剩余列”堆在最后面。

## 2. 修改计划

### 2.1 扩展映射列表

在 `evaluate.py` 中，扩展 `mappings` 列表，显式包含所有需要对比的列名（根据您的标签文件截图）：

```python
mappings = [
    ("是否属于城市更新研究", "是否属于城市更新研究", "Urban Renewal"),
    ("空间研究/非空间研究", "空间研究/非空间研究", "Spatial Study"),
    ("空间等级", "空间等级", "Spatial Level"),
    ("具体空间描述", "具体空间描述", "Spatial Desc")
]
```

### 2.2 强化列相邻逻辑

代码现有的逻辑是：

```python
# Add to column order: Truth, Pred, Diff
final_cols.extend([t_col, p_col, diff_col_name])
```

这已经实现了“真值-预测值-Diff”相邻。只要我们将所有关心的指标都加入 `mappings`，它们就会按顺序正确排列。

### 2.3 再次确认 Diff 值逻辑

您之前的要求是“正确匹配为1，不匹配为0”。我将一并落实这个修改。

## 3. 实施步骤

1. **修改** **`evaluate.py`**：

   * 扩充 `mappings` 以覆盖 `空间等级` 和 `具体空间描述`。

   * 修改 Diff 计算逻辑：`1` (Match), 0` `(Mismatch)。

   * 确保列排序逻辑对所有 mapping 生效。

