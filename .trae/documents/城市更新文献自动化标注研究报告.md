# 城市更新文献自动化标注研究报告

## 1. 项目背景与目标
本项目旨在构建一个基于大语言模型（LLM）的自动化文献标注系统，用于从海量学术文献的标题和摘要中提取关键信息。核心任务是识别该文献是否属于“城市更新”领域、是否包含“空间研究”、其“空间等级”及“具体空间描述”。通过引入多策略提示工程（Single, Stepwise, CoT, Reflection）和混合并发调度架构，实现了高精度、高效率的自动化处理。

## 2. 系统架构与技术实现

### 2.1 核心架构
*   **混合调度引擎 (Hybrid Scheduler)**:
    *   **并行处理 (Parallel Group)**: `single`, `stepwise`, `cot`, `reflection` 策略采用线程池并发执行，最大化吞吐量。
    *   **串行处理 (Serial Group)**: `stepwise_long` (长上下文) 策略在主线程串行执行，确保跨论文记忆的连贯性。
    *   **优势**: 解决了“长上下文记忆”与“高并发”的矛盾，在保证实验科学性的同时提升了 4-5 倍的处理速度。

### 2.2 提示词策略 (Prompt Engineering)
针对指标体系，设计了四层递进的策略：
1.  **Single (单步)**: 一次性提取所有字段，效率最高。
2.  **Stepwise (分步)**: 将任务拆解为 3 个步骤（更新判定 -> 空间判定 -> 空间提取），降低认知负荷。
3.  **CoT (思维链)**: 强制模型在输出前进行 `<thinking>` 推理，显式检查“是否新建”、“是否仅为背景”。
4.  **Reflection (自我反思)**: 引入 Critique 环节，让模型自我审查并修正初步结论。

### 2.3 指标体系 (9级空间分类)
根据最新的研究需求，建立了严格的判定标准：
*   **城市更新**: 必须针对**既有建成区**的干预，排除新城开发和一般城市化。
*   **空间研究**: 必须以空间为**研究对象**，排除背景提及。
*   **空间等级**: 全新的 9 级分类（Global, Multi-country, Country, Multi-province, Province, Urban Agglomeration, Single City, Multi-neighborhood, Single Neighborhood）。

## 3. 当前效果评估

基于 `Data/test2` 数据集的初步运行结果 (`Eval_stepwise_few_20260128_111609.xlsx`)，系统表现如下：

*   **准确性**: 
    *   在“是否属于城市更新”和“空间研究”的二分类任务上，Stepwise Few-shot 策略表现出了极高的准确率（Diff 列主要为 0）。
    *   空间等级判定能够准确区分 `Single City` (如 Barcelona) 和 `Multi-country`。
*   **稳定性**:
    *   混合调度逻辑运行稳定，未出现上下文污染或线程冲突。
    *   API 调用通过 OpenAI SDK 适配，支持自动重试和速率限制，鲁棒性强。

## 4. 结论与展望
本项目成功搭建了一套工业级的文献自动化标注流水线。
*   **已实现**: 多模型适配、高并发处理、长上下文实验、复杂提示词策略。
*   **下一步**: 建议运行更大规模的数据集（如 1000+ 篇），并利用 `scripts/merge_results.py` 生成全策略对比报告，以量化各策略的 F1-Score 差异，选出最佳策略组合。
